import{C as e,G as t,H as n,Q as r,S as i,T as a,U as o,V as s,W as c,X as l,Y as u,Z as d,a as f,d as p,i as m,l as h,n as g,o as _,p as v,r as y,s as b,t as x,u as S,x as C}from"./index-CsGwgG2_.js";var w=e(`hash`,[[`line`,{x1:`4`,x2:`20`,y1:`9`,y2:`9`,key:`4lhtct`}],[`line`,{x1:`4`,x2:`20`,y1:`15`,y2:`15`,key:`vyu0kd`}],[`line`,{x1:`10`,x2:`8`,y1:`3`,y2:`21`,key:`1ggp8o`}],[`line`,{x1:`16`,x2:`14`,y1:`3`,y2:`21`,key:`weycgp`}]]),T=e(`search`,[[`path`,{d:`m21 21-4.34-4.34`,key:`14j7rj`}],[`circle`,{cx:`11`,cy:`11`,r:`8`,key:`4ej97u`}]]),E=r(d());function D(e,t){let[n,r]=(0,E.useState)(e);return(0,E.useEffect)(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n}var O=D,k=r(n());function A({value:e,onChange:t,onSearch:n}){let{t:r}=c(),[i,a]=(0,E.useState)(e||``),o=O(i,500),s=(0,E.useRef)(!1);(0,E.useEffect)(()=>{if(s.current){s.current=!1;return}o!==e&&(t?.(o),o.trim()&&n?.(o.trim()))},[o,e,t,n]),(0,E.useEffect)(()=>{a(e||``)},[e]);let l=(0,E.useCallback)(()=>{s.current=!0,a(``),t?.(``)},[t]);return(0,k.jsxs)(`div`,{className:`relative p-4!`,children:[(0,k.jsx)(T,{className:`absolute left-10 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground`}),(0,k.jsx)(h,{type:`text`,value:i,onChange:e=>a(e.target.value),placeholder:r(`write_sth`),className:`pl-15 pr-10 h-11 bg-secondary/50 border-none rounded-xl focus-visible:ring-1`}),i&&(0,k.jsx)(`button`,{type:`button`,onClick:l,className:`absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 rounded-full bg-muted-foreground/20 hover:bg-muted-foreground/30 flex items-center justify-center transition-colors`,children:(0,k.jsx)(C,{className:`h-3 w-3 text-muted-foreground`})})]})}var j=A,M=[`all`,`topics`,`users`];function N({activeMode:e,onChange:t}){let{t:n}=c();return(0,k.jsx)(`div`,{className:`flex border-b border-border`,id:`SearchTabs`,children:M.map(r=>(0,k.jsxs)(`button`,{onClick:()=>t(r),className:o(`flex-1 py-3 text-sm font-medium transition-colors relative`,e===r?`text-foreground`:`text-muted-foreground !hover:text-foreground/80`),children:[n(`${r}`),e===r&&(0,k.jsx)(`span`,{className:`absolute bottom-0 left-0! right-0! h-0.5! bg-foreground`})]},r))})}var P=N;function F({user:e}){let{t:n}=c(),r=u(),o=l(a),[d,f]=(0,E.useState)(!1),[m,h]=(0,E.useState)(!1);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(`div`,{className:`flex items-start gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,k.jsx)(v,{currentUser:e}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,k.jsxs)(`div`,{className:`flex items-center gap-1!`,children:[(0,k.jsx)(`span`,{className:`font-semibold! text-sm truncate`,children:e.username}),e.verified&&(0,k.jsx)(i,{className:`h-4 w-4 text-blue-500 shrink-0`})]}),e.name&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground truncate`,children:e.name}),e.bio&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-2 mt-0.5`,children:e.bio}),(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1!`,children:n(`followers`,{count:e.followers_count||0})})]}),(0,k.jsx)(s,{variant:e.is_following?`outline`:`default`,size:`sm`,onClick:async()=>{if(!o){h(!0);return}f(!0);try{e.is_following?(await r(b(e.id)).unwrap(),t.success(n(`followed`))):(await r(x(e.id)).unwrap(),t.success(n(`unfollowed`)))}catch(e){t.error(n(`follow_failed`,{message:e}))}finally{f(!1)}},disabled:d,className:`shrink-0 rounded-lg! px-5!`,children:e.is_following?n(`following`):n(`follow`)})]}),(0,k.jsx)(p,{open:m,onOpenChange:h})]})}var I=F;function L({topic:e}){let{t}=c();return(0,k.jsxs)(`div`,{className:`flex items-center gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,k.jsx)(`div`,{className:`h-10 w-10 rounded-full bg-secondary flex items-center justify-center shrink-0`,children:(0,k.jsx)(w,{className:`h-5 w-5 text-muted-foreground`})}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,k.jsx)(`p`,{className:`font-semibold text-sm`,children:e.name}),e.description&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-1`,children:e.description}),(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground mt-0.5!`,children:t(`posts`,{count:e.posts_count||0})})]})]})}var R=L;function z({type:e=`user`}){return(0,k.jsxs)(`div`,{className:`flex items-start gap-3 p-4`,children:[(0,k.jsx)(S,{className:`h-10 w-10 rounded-full shrink-0`}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0 space-y-2`,children:[(0,k.jsx)(S,{className:`h-4 w-24`}),(0,k.jsx)(S,{className:`h-3 w-32`}),e===`user`&&(0,k.jsx)(S,{className:`h-3 w-20`})]}),e===`user`&&(0,k.jsx)(S,{className:`h-8 w-20 rounded-xl shrink-0`})]})}var B=z;function V(){let{t:e}=c(),t=u(),{query:n,searchMode:r,topics:i,users:a,loading:o}=l(e=>e.search),s=(0,E.useCallback)((e,n)=>{n===`users`?t(g({page:1,perPage:20})):e.trim()&&(n===`all`?t(y({query:e,page:1})):n===`topics`&&t(m({query:e})))},[t]),d=(0,E.useCallback)(e=>{t(_(e)),s(e,r)},[t,r,s]),p=(0,E.useCallback)(e=>{t(f(e)),s(n,e)},[t,n,s]);(0,E.useEffect)(()=>{window.scrollTo(0,0),r===`users`&&a.length===0&&t(g({page:1,perPage:20}))},[t,r,a.length]);let h=()=>(0,k.jsx)(k.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,k.jsx)(B,{type:r===`topics`?`topic`:`user`},t))}),v=()=>i.length===0&&n&&!o?(0,k.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):(0,k.jsx)(`div`,{className:`flex flex-col gap-1 divide-y! divide-border! h-[calc(100%-110px)]! md:h-[calc(100%-130px)]!`,children:(0,k.jsx)(`div`,{className:`h-full! overflow-y-auto!`,children:i.map(e=>(0,k.jsx)(R,{topic:e},e.id))})}),b=()=>a.length===0&&!o?(0,k.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):(0,k.jsx)(`div`,{className:`flex flex-col gap-1 divide-y! divide-border! h-[calc(100%-110px)]! md:h-[calc(100%-130px)]!`,children:(0,k.jsx)(`div`,{className:`h-full! overflow-y-auto!`,children:a.map(e=>(0,k.jsx)(I,{user:e},e.id))})});return(0,k.jsx)(`div`,{id:`Search`,className:`w-full md:w-[calc(100%-50px)] max-w-[700px]! h-full! flex justify-center px-6! md:px-0!`,children:(0,k.jsxs)(`div`,{className:`w-full! h-full md:min-w-[380px]`,children:[(0,k.jsx)(j,{value:n,onChange:e=>t(_(e)),onSearch:d}),(0,k.jsx)(P,{activeMode:r,onChange:p}),(()=>{if(o)return h();switch(r){case`topics`:return v();case`users`:return b();default:{let t=i.length>0,r=a.length>0;return!t&&!r&&n?(0,k.jsx)(`p`,{className:`text-center text-muted-foreground py-8`,children:e(`no_result`)}):(0,k.jsxs)(`div`,{className:`flex flex-col gap-1 divide-y! divide-border! h-[calc(100%-110px)]! md:h-[calc(100%-130px)]!`,children:[t&&(0,k.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`topics`)}),r&&(0,k.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`users`)}),(0,k.jsxs)(`div`,{className:`h-full! overflow-y-auto!`,children:[t&&(0,k.jsx)(`div`,{className:``,children:i.slice(0,3).map(e=>(0,k.jsx)(R,{topic:e},e.id))}),r&&(0,k.jsx)(`div`,{className:``,children:a.map(e=>(0,k.jsx)(I,{user:e},e.id))})]})]})}}})()]})})}var H=V;export{H as default};