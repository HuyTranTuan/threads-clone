import{t as e}from"./password-input-a1UGY-C-.js";import{D as t,E as n,F as r,G as i,H as a,K as o,L as s,M as c,N as l,O as u,P as d,Q as f,R as p,S as m,W as h,X as g,Y as _,Z as v,_ as y,c as b,j as x,k as S,l as C,m as w,q as T}from"./index-DrylHBWn.js";var E=f(v()),D=f(a()),O=()=>{let a=T(),o=_(),{t:f}=h(),v=g(m),[b,O]=(0,E.useState)(``),[k,A]=(0,E.useState)(``),[j,M]=(0,E.useState)(``),[N,P]=(0,E.useState)(``),{register:F,handleSubmit:I,setError:L,clearErrors:R,formState:{errors:z}}=p({resolver:s(y),mode:`onChange`}),B=(0,E.useCallback)(x(async e=>{if(!(!e||e.length<3))try{await r.validateUsername(e),R(`username`)}catch(e){L(`username`,{type:`manual`,message:e.response?.data?.message||f(`username_existed`)})}},700),[]),V=(0,E.useCallback)(x(async e=>{if(!e){O(``);return}if(!l(e)){O(f(`email_invalid`)),R(`email`);return}O(``);try{await r.validateEmail(e),R(`email`)}catch(e){L(`email`,{type:`manual`,message:e.response?.data?.message||f(`email_existed`)})}},1200),[]),H=(0,E.useCallback)(x(e=>{if(!e){A(``);return}d(e)?A(``):(A(f(`password_at_least`)),R(`password`))},700),[]),U=(0,E.useCallback)(x(e=>{if(!e){M(``);return}c(N,e)?M(``):(M(f(`confirmpassword_not_match`)),R(`password_confirmation`))},700),[N]);return(0,E.useEffect)(()=>()=>{o(S())},[o]),(0,D.jsxs)(`form`,{onSubmit:I(async e=>{o(t());try{let t=await r.register(e);t.access_token&&localStorage.setItem(`access_token`,t.access_token),t.refresh_token&&localStorage.setItem(`refresh_token`,t.refresh_token),t.user&&localStorage.setItem(`user`,t.user),o(u(t)),i.success(f(`signup_success`),{description:f(`we_have_sent_verify_email`),duration:3e3}),setTimeout(()=>{a(`/auth/login`)},500)}catch(e){let t=e.response?.data||{message:e.message};o(n(t));let r=t.message||f(`signup_fail`);t.errors&&Object.keys(t.errors).forEach(e=>{L(e,{type:`manual`,message:t.errors[e][0]})}),i.error(f(`signup_fail`),{description:r})}}),className:`w-full flex flex-col gap-2`,children:[(0,D.jsx)(C,{type:`text`,placeholder:f(`username`),...F(`username`),onChange:e=>{F(`username`).onChange(e),B(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.username?`border-destructive`:``}`,disabled:v}),z.username&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.username.message}),(0,D.jsx)(C,{type:`email`,placeholder:f(`email`),...F(`email`),onChange:e=>{F(`email`).onChange(e),V(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.email||b?`border-destructive`:``}`,disabled:v}),b&&(0,D.jsx)(`p`,{className:`text-destructive`,children:b}),z.email&&!b&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.email.message}),(0,D.jsx)(e,{placeholder:f(`password`),...F(`password`),onChange:e=>{let t=e.target.value;F(`password`).onChange(e),P(t),H(t)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password||k?`border-destructive`:``}`,disabled:v}),k&&(0,D.jsx)(`p`,{className:`text-destructive`,children:k}),z.password&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password.message}),(0,D.jsx)(e,{type:`password`,placeholder:f(`confirm_password`),...F(`password_confirmation`),onChange:e=>{F(`password_confirmation`).onChange(e),U(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password_confirmation||j?`border-destructive`:``}`,disabled:v}),j&&(0,D.jsx)(`p`,{className:`text-destructive`,children:j}),z.password_confirmation&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password_confirmation.message}),(0,D.jsx)(w,{type:`submit`,className:`w-full h-12 bg-foreground text-background !hover:bg-systemtext cursor-pointer rounded-2xl`,disabled:v,children:f(v?`siging_up`:`sigup`)})]})};function k(){let{t:e}=h();return(0,D.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6! mx-auto! flex flex-col gap-2 absolute top-full left-[50%] -translate-x-[50%] translate-y-[50%]`,children:[(0,D.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[(0,D.jsx)(`h1`,{className:`text-center text-base sm:text-lg sm:my-4 text-foreground font-bold! text-[16px]`,children:e(`signup_threads`)}),(0,D.jsx)(O,{}),(0,D.jsx)(`div`,{className:`text-center`,children:(0,D.jsx)(o,{to:`/auth/forgot-password`,className:`text-sm text-foreground`,children:e(`forgot_psw`)})}),(0,D.jsxs)(`div`,{className:`relative my-6!`,children:[(0,D.jsx)(b,{className:`bg-normaltext!`}),(0,D.jsx)(`span`,{className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 px-4 text-sm text-systemtext!`,children:e(`or`)})]})]}),(0,D.jsxs)(`p`,{className:`text-center`,children:[e(`havent_got_account`),(0,D.jsx)(o,{to:`/auth/login`,className:`text-foreground font-semibold hover:underline`,children:e(`login`)})]})]})}var A=k;export{A as default};