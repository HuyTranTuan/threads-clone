import{B as e,H as t,Q as n,U as r,V as i,W as a,X as o,Y as s,Z as c,a as l,b as u,d,i as f,l as p,m,n as h,o as g,p as _,r as v,s as y,t as b,u as x,z as S}from"./index-DrylHBWn.js";var C=i(`hash`,[[`line`,{x1:`4`,x2:`20`,y1:`9`,y2:`9`,key:`4lhtct`}],[`line`,{x1:`4`,x2:`20`,y1:`15`,y2:`15`,key:`vyu0kd`}],[`line`,{x1:`10`,x2:`8`,y1:`3`,y2:`21`,key:`1ggp8o`}],[`line`,{x1:`16`,x2:`14`,y1:`3`,y2:`21`,key:`weycgp`}]]),w=i(`search`,[[`path`,{d:`m21 21-4.34-4.34`,key:`14j7rj`}],[`circle`,{cx:`11`,cy:`11`,r:`8`,key:`4ej97u`}]]),T=n(c());function E(e,t){let[n,r]=(0,T.useState)(e);return(0,T.useEffect)(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n}var D=E,O=n(t());function k({value:e,onChange:t,onSearch:n}){let{t:r}=a(),[i,o]=(0,T.useState)(e||``),s=D(i,500),c=(0,T.useRef)(!1);(0,T.useEffect)(()=>{if(c.current){c.current=!1;return}s!==e&&(t?.(s),s.trim()&&n?.(s.trim()))},[s,e,t,n]),(0,T.useEffect)(()=>{o(e||``)},[e]);let l=(0,T.useCallback)(()=>{c.current=!0,o(``),t?.(``)},[t]);return(0,O.jsxs)(`div`,{className:`relative`,children:[(0,O.jsx)(w,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground`}),(0,O.jsx)(p,{type:`text`,value:i,onChange:e=>o(e.target.value),placeholder:r(`write_sth`),className:`pl-10 pr-10 h-11 bg-secondary/50 border-none rounded-xl focus-visible:ring-1`}),i&&(0,O.jsx)(`button`,{type:`button`,onClick:l,className:`absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 rounded-full bg-muted-foreground/20 hover:bg-muted-foreground/30 flex items-center justify-center transition-colors`,children:(0,O.jsx)(S,{className:`h-3 w-3 text-muted-foreground`})})]})}var A=k,j=[`all`,`topics`,`users`];function M({activeMode:e,onChange:t}){let{t:n}=a();return(0,O.jsx)(`div`,{className:`flex border-b border-border`,children:j.map(i=>(0,O.jsxs)(`button`,{onClick:()=>t(i),className:r(`flex-1 py-3 text-sm font-medium transition-colors relative`,e===i?`text-foreground`:`text-muted-foreground !hover:text-foreground/80`),children:[n(`${i}`),e===i&&(0,O.jsx)(`span`,{className:`absolute bottom-0 left-0! right-0! h-0.5! bg-foreground`})]},i))})}var N=M;function P({user:t}){let{t:n}=a(),r=s(),i=o(u),[c,l]=(0,T.useState)(!1),[f,p]=(0,T.useState)(!1);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(`div`,{className:`flex items-start gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,O.jsx)(_,{currentUser:t}),(0,O.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,O.jsxs)(`div`,{className:`flex items-center gap-1!`,children:[(0,O.jsx)(`span`,{className:`font-semibold! text-sm truncate`,children:t.username}),t.verified&&(0,O.jsx)(e,{className:`h-4 w-4 text-blue-500 shrink-0`})]}),t.name&&(0,O.jsx)(`p`,{className:`text-sm text-muted-foreground truncate`,children:t.name}),t.bio&&(0,O.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-2 mt-0.5`,children:t.bio}),(0,O.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1!`,children:n(`followers`,{count:t.followers_count||0})})]}),(0,O.jsx)(m,{variant:t.is_following?`outline`:`default`,size:`sm`,onClick:async()=>{if(!i){p(!0);return}l(!0);try{t.is_following?await r(y(t.id)).unwrap():await r(b(t.id)).unwrap()}catch(e){console.error(`Follow action failed:`,e)}finally{l(!1)}},disabled:c,className:`shrink-0 rounded-lg! px-5!`,children:t.is_following?n(`following`):n(`follow`)})]}),(0,O.jsx)(d,{open:f,onOpenChange:p})]})}var F=P;function I({topic:e}){let{t}=a();return(0,O.jsxs)(`div`,{className:`flex items-center gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,O.jsx)(`div`,{className:`h-10 w-10 rounded-full bg-secondary flex items-center justify-center shrink-0`,children:(0,O.jsx)(C,{className:`h-5 w-5 text-muted-foreground`})}),(0,O.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,O.jsx)(`p`,{className:`font-semibold text-sm`,children:e.name}),e.description&&(0,O.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-1`,children:e.description}),(0,O.jsx)(`p`,{className:`text-sm text-muted-foreground mt-0.5!`,children:t(`posts`,{count:e.posts_count||0})})]})]})}var L=I;function R({type:e=`user`}){return(0,O.jsxs)(`div`,{className:`flex items-start gap-3 p-4`,children:[(0,O.jsx)(x,{className:`h-10 w-10 rounded-full shrink-0`}),(0,O.jsxs)(`div`,{className:`flex-1 min-w-0 space-y-2`,children:[(0,O.jsx)(x,{className:`h-4 w-24`}),(0,O.jsx)(x,{className:`h-3 w-32`}),e===`user`&&(0,O.jsx)(x,{className:`h-3 w-20`})]}),e===`user`&&(0,O.jsx)(x,{className:`h-8 w-20 rounded-xl shrink-0`})]})}var z=R;function B(){let{t:e}=a(),t=s(),{query:n,searchMode:r,topics:i,users:c,loading:u}=o(e=>e.search),d=(0,T.useCallback)((e,n)=>{n===`users`?t(h({page:1,perPage:20})):e.trim()&&(n===`all`?t(v({query:e,page:1})):n===`topics`&&t(f({query:e})))},[t]),p=(0,T.useCallback)(e=>{t(g(e)),d(e,r)},[t,r,d]),m=(0,T.useCallback)(e=>{t(l(e)),d(n,e)},[t,n,d]);(0,T.useEffect)(()=>{window.scrollTo(0,0),r===`users`&&c.length===0&&t(h({page:1,perPage:20}))},[t,r,c.length]);let _=()=>(0,O.jsx)(O.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,O.jsx)(z,{type:r===`topics`?`topic`:`user`},t))}),y=()=>i.length===0&&n&&!u?(0,O.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):i.map(e=>(0,O.jsx)(L,{topic:e},e.id)),b=()=>c.length===0&&!u?(0,O.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):c.map(e=>(0,O.jsx)(F,{user:e},e.id));return(0,O.jsx)(`div`,{id:`Search`,className:`w-full! md:w-[calc(100%-80px)]! flex justify-center px-6! md:px-0!`,children:(0,O.jsxs)(`div`,{className:`w-full! md:min-w-[380px] md:max-w-[700px]! h-[calc(100%-60px)]`,children:[(0,O.jsx)(`div`,{className:`p-4!`,children:(0,O.jsx)(A,{value:n,onChange:e=>t(g(e)),onSearch:p})}),(0,O.jsx)(N,{activeMode:r,onChange:m}),(0,O.jsx)(`div`,{className:`flex flex-col gap-1 divide-y! divide-border!`,children:(()=>{if(u)return _();switch(r){case`topics`:return y();case`users`:return b();case`all`:default:{let t=i.length>0,r=c.length>0;return!t&&!r&&n?(0,O.jsx)(`p`,{className:`text-center text-muted-foreground py-8`,children:e(`no_result`)}):(0,O.jsxs)(O.Fragment,{children:[t&&(0,O.jsxs)(`div`,{children:[(0,O.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`topics`)}),i.slice(0,3).map(e=>(0,O.jsx)(L,{topic:e},e.id))]}),r&&(0,O.jsxs)(`div`,{children:[(0,O.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`users`)}),c.map(e=>(0,O.jsx)(F,{user:e},e.id))]})]})}}})()})]})})}var V=B;export{V as default};