import{F as e,G as t,H as n,J as r,P as i,Q as a,V as o,W as s,Y as c,Z as l,k as u,q as d}from"./index-BJ0Qenmi.js";var f=a(l()),p=a(n()),m=()=>{let{t:n}=s(),a=d(),l=c(),[m]=r(),h=m.get(`token`),[g,_]=(0,f.useState)(!0),[v,y]=(0,f.useState)(!1),[b,x]=(0,f.useState)(`verifying`),[S,C]=(0,f.useState)(``);(0,f.useEffect)(()=>{if(!h){x(`error`),C(n(`invalid_token`)),_(!1);return}(async()=>{try{let{user:e}=await i.verifyEmail(h)||{};e&&l(u(e)),x(`success`),C(n(`verify_successed`)),t(n(`verify_successed`)),setTimeout(()=>{window.close()},4e3)}catch(e){let r=e.response?.status;r===400||r===404||r===422?localStorage.getItem(`refresh_token`)?(x(`not-verified`),C(n(`not_verified`)),t.message?.(n(`not_verified`))||t(n(`not_verified`))):(x(`not-verified-no-auth`),C(n(`need_login_to_verify`)),t.message?.(n(`need_login_to_verify`))||t(n(`need_login_to_verify`))):(x(`error`),C(n(`verify_failed`)),t.error(e.response?.data?.message||n(`verify_failed`)))}finally{_(!1)}})()},[l,a,n,h]);let w=async()=>{y(!0);try{await i.resendVerificationEmail(),t.success(n(`verifying_email_sent`)),C(n(`check_email`))}catch(e){let r=e.response?.data?.message||n(`verify_failed`);t.error(r)}finally{y(!1)}};return(0,p.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6!flex flex-col gap-2 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2`,children:[(b===`verifying`||g)&&(0,p.jsxs)(`div`,{className:`flex flex-col gap-2.5! items-center`,children:[(0,p.jsx)(e,{className:`w-12 h-12`}),(0,p.jsx)(`p`,{className:`mt-4 text-lg text-foreground`,children:n(`verifying`)})]}),b===`not-verified`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center gap-2.5!`,children:[(0,p.jsx)(`h1`,{className:`text-center text-2xl! sm:my-4 text-foreground font-bold!`,children:n(`verify_email_title`)}),(0,p.jsx)(`p`,{className:`text-center text-sm! text-(--systemtext) mb-6`,children:S}),(0,p.jsx)(o,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{className:`mr-2`}),n(`sending`)]}):n(`resend_verify`)})]}),b===`success`&&(0,p.jsxs)(`div`,{className:`flex flex-col gap-2.5! items-center`,children:[(0,p.jsx)(`h1`,{className:`text-2xl! font-bold! text-foreground mb-2!`,children:n(`verify_successed`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-4`,children:S}),(0,p.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:n(`back_to_login`)}),(0,p.jsx)(Link,{to:`/auth/login`,state:{verified:!0}})]}),b===`error`&&(0,p.jsxs)(`div`,{className:`flex flex-col! gap-2.5! items-center`,children:[(0,p.jsx)(`h1`,{className:`text-2xl! font-bold! text-foreground mb-2!`,children:n(`verify_failed`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6!`,children:S}),(0,p.jsx)(o,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{className:`mr-2!`}),n(`sending`)]}):n(`resend_verify`)})]})]})};export{m as default};