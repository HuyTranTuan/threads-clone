import{t as e}from"./password-input-CdTFCAg9.js";import{A as t,D as n,E as r,G as i,H as a,I as o,K as s,L as c,M as l,N as u,O as d,P as f,Q as p,T as m,V as h,W as g,X as _,Y as v,Z as y,c as b,g as x,j as S,l as C,q as w,x as T}from"./index-C9mPxSbV.js";var E=p(y()),D=p(a()),O=()=>{let a=w(),s=v(),{t:p}=g(),y=_(T),[b,O]=(0,E.useState)(``),[k,A]=(0,E.useState)(``),[j,M]=(0,E.useState)(``),[N,P]=(0,E.useState)(``),{register:F,handleSubmit:I,setError:L,clearErrors:R,formState:{errors:z}}=c({resolver:o(x),mode:`onChange`}),B=(0,E.useCallback)(t(async e=>{if(!(!e||e.length<3))try{await f.validateUsername(e),R(`username`)}catch(e){L(`username`,{type:`manual`,message:e.response?.data?.message||p(`username_existed`)})}},700),[]),V=(0,E.useCallback)(t(async e=>{if(!e){O(``);return}if(!l(e)){O(p(`email_invalid`)),R(`email`);return}O(``);try{await f.validateEmail(e),R(`email`)}catch(e){L(`email`,{type:`manual`,message:e.response?.data?.message||p(`email_existed`)})}},1200),[]),H=(0,E.useCallback)(t(e=>{if(!e){A(``);return}u(e)?A(``):(A(p(`password_at_least`)),R(`password`))},700),[]),U=(0,E.useCallback)(t(e=>{if(!e){M(``);return}S(N,e)?M(``):(M(p(`confirmpassword_not_match`)),R(`password_confirmation`))},700),[N]);return(0,E.useEffect)(()=>()=>{s(d())},[s]),(0,D.jsxs)(`form`,{onSubmit:I(async e=>{s(r());try{let t=await f.register(e);t.access_token&&localStorage.setItem(`access_token`,t.access_token),t.refresh_token&&localStorage.setItem(`refresh_token`,t.refresh_token),t.user&&localStorage.setItem(`user`,t.user),s(n(t)),i.success(p(`signup_success`),{description:p(`we_have_sent_verify_email`),duration:3e3}),setTimeout(()=>{a(`/auth/login`)},500)}catch(e){let t=e.response?.data||{message:e.message};s(m(t));let n=t.message||p(`signup_fail`);t.errors&&Object.keys(t.errors).forEach(e=>{L(e,{type:`manual`,message:t.errors[e][0]})}),i.error(p(`signup_fail`),{description:n})}}),className:`w-full flex flex-col gap-2`,children:[(0,D.jsx)(C,{type:`text`,placeholder:p(`username`),...F(`username`),onChange:e=>{F(`username`).onChange(e),B(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.username?`border-destructive`:``}`,disabled:y}),z.username&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.username.message}),(0,D.jsx)(C,{type:`email`,placeholder:p(`email`),...F(`email`),onChange:e=>{F(`email`).onChange(e),V(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.email||b?`border-destructive`:``}`,disabled:y}),b&&(0,D.jsx)(`p`,{className:`text-destructive`,children:b}),z.email&&!b&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.email.message}),(0,D.jsx)(e,{placeholder:p(`password`),...F(`password`),onChange:e=>{let t=e.target.value;F(`password`).onChange(e),P(t),H(t)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password||k?`border-destructive`:``}`,disabled:y}),k&&(0,D.jsx)(`p`,{className:`text-destructive`,children:k}),z.password&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password.message}),(0,D.jsx)(e,{type:`password`,placeholder:p(`confirm_password`),...F(`password_confirmation`),onChange:e=>{F(`password_confirmation`).onChange(e),U(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password_confirmation||j?`border-destructive`:``}`,disabled:y}),j&&(0,D.jsx)(`p`,{className:`text-destructive`,children:j}),z.password_confirmation&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password_confirmation.message}),(0,D.jsx)(h,{type:`submit`,className:`w-full h-12 bg-foreground text-background !hover:bg-systemtext cursor-pointer rounded-2xl`,disabled:y,children:p(y?`siging_up`:`sigup`)})]})};function k(){let{t:e}=g();return(0,D.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6!flex flex-col gap-2 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2`,children:[(0,D.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[(0,D.jsx)(`h1`,{className:`text-center text-xl! sm:my-4 text-foreground font-bold!`,children:e(`signup_threads`)}),(0,D.jsx)(O,{}),(0,D.jsx)(`div`,{className:`text-center mt-2.5!`,children:(0,D.jsx)(s,{to:`/auth/forgot-password`,className:`text-foreground font-bold! hover:text-(--systemtext)`,children:e(`forgot_psw`)})}),(0,D.jsxs)(`div`,{className:`relative my-6!`,children:[(0,D.jsx)(b,{className:`bg-normaltext!`}),(0,D.jsx)(`span`,{className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 px-4 text-sm text-systemtext!`,children:e(`or`)})]})]}),(0,D.jsxs)(`p`,{className:`text-center`,children:[e(`havent_got_account`),(0,D.jsx)(s,{to:`/auth/login`,className:`text-foreground font-bold! hover:text-(--systemtext)`,children:e(`login`)})]})]})}var A=k;export{A as default};