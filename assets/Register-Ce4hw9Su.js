import{t as e}from"./password-input-B-AdPmP3.js";import{B as t,D as n,G as r,H as i,I as a,K as o,L as s,M as c,N as l,P as u,Q as d,R as f,V as p,W as m,X as h,Y as g,Z as _,b as v,c as y,g as b,j as x,l as S,q as C,y as w,z as T}from"./index-CsGwgG2_.js";var E=d(_()),D=d(i()),O=()=>{let i=C(),o=g(),{t:d}=m(),_=h(n),[y,O]=(0,E.useState)(``),[k,A]=(0,E.useState)(``),[j,M]=(0,E.useState)(``),[N,P]=(0,E.useState)(``),{register:F,handleSubmit:I,setError:L,clearErrors:R,formState:{errors:z}}=v({resolver:w(b),mode:`onChange`}),B=(0,E.useCallback)(s(async e=>{if(!(!e||e.length<3))try{await a.validateUsername(e),R(`username`)}catch(e){L(`username`,{type:`manual`,message:e.response?.data?.message||d(`username_existed`)})}},700),[]),V=(0,E.useCallback)(s(async e=>{if(!e){O(``);return}if(!T(e)){O(d(`email_invalid`)),R(`email`);return}O(``);try{await a.validateEmail(e),R(`email`)}catch(e){L(`email`,{type:`manual`,message:e.response?.data?.message||d(`email_existed`)})}},1200),[]),H=(0,E.useCallback)(s(e=>{if(!e){A(``);return}t(e)?A(``):(A(d(`password_at_least`)),R(`password`))},700),[]),U=(0,E.useCallback)(s(e=>{if(!e){M(``);return}f(N,e)?M(``):(M(d(`confirmpassword_not_match`)),R(`password_confirmation`))},700),[N]);return(0,E.useEffect)(()=>()=>{o(u())},[o]),(0,D.jsxs)(`form`,{onSubmit:I(async e=>{o(c());try{let t=await a.register(e);t.access_token&&localStorage.setItem(`access_token`,t.access_token),t.refresh_token&&localStorage.setItem(`refresh_token`,t.refresh_token),t.user&&localStorage.setItem(`user`,t.user),o(l(t)),r.success(d(`signup_success`),{description:d(`we_have_sent_verify_email`),duration:3e3}),setTimeout(()=>{i(`/auth/login`)},500)}catch(e){let t=e.response?.data||{message:e.message};o(x(t));let n=t.message||d(`signup_fail`);t.errors&&Object.keys(t.errors).forEach(e=>{L(e,{type:`manual`,message:t.errors[e][0]})}),r.error(d(`signup_fail`),{description:n})}}),className:`w-full flex flex-col gap-2`,children:[(0,D.jsx)(S,{type:`text`,placeholder:d(`username`),...F(`username`),onChange:e=>{F(`username`).onChange(e),B(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.username?`border-destructive`:``}`,disabled:_}),z.username&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.username.message}),(0,D.jsx)(S,{type:`email`,placeholder:d(`email`),...F(`email`),onChange:e=>{F(`email`).onChange(e),V(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.email||y?`border-destructive`:``}`,disabled:_}),y&&(0,D.jsx)(`p`,{className:`text-destructive`,children:y}),z.email&&!y&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.email.message}),(0,D.jsx)(e,{placeholder:d(`password`),...F(`password`),onChange:e=>{let t=e.target.value;F(`password`).onChange(e),P(t),H(t)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password||k?`border-destructive`:``}`,disabled:_}),k&&(0,D.jsx)(`p`,{className:`text-destructive`,children:k}),z.password&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password.message}),(0,D.jsx)(e,{type:`password`,placeholder:d(`confirm_password`),...F(`password_confirmation`),onChange:e=>{F(`password_confirmation`).onChange(e),U(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password_confirmation||j?`border-destructive`:``}`,disabled:_}),j&&(0,D.jsx)(`p`,{className:`text-destructive`,children:j}),z.password_confirmation&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password_confirmation.message}),(0,D.jsx)(p,{type:`submit`,className:`w-full h-12 bg-foreground text-background !hover:bg-systemtext cursor-pointer rounded-2xl`,disabled:_,children:d(_?`siging_up`:`sigup`)})]})};function k(){let{t:e}=m();return(0,D.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6!flex flex-col gap-2 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2`,children:[(0,D.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[(0,D.jsx)(`h1`,{className:`text-center text-xl! sm:my-4 text-foreground font-bold!`,children:e(`signup_threads`)}),(0,D.jsx)(O,{}),(0,D.jsx)(`div`,{className:`text-center mt-2.5!`,children:(0,D.jsx)(o,{to:`/auth/forgot-password`,className:`text-foreground font-bold! hover:text-(--systemtext)`,children:e(`forgot_psw`)})}),(0,D.jsxs)(`div`,{className:`relative my-6!`,children:[(0,D.jsx)(y,{className:`bg-normaltext!`}),(0,D.jsx)(`span`,{className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 px-4 text-sm text-systemtext!`,children:e(`or`)})]})]}),(0,D.jsxs)(`p`,{className:`text-center`,children:[e(`havent_got_account`),(0,D.jsx)(o,{to:`/auth/login`,className:`text-foreground font-bold! hover:text-(--systemtext)`,children:e(`login`)})]})]})}var A=k;export{A as default};