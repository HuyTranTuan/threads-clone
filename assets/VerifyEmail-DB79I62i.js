import{A as e,F as t,G as n,H as r,I as i,J as a,Q as o,W as s,Y as c,Z as l,m as u,q as d}from"./index-DrylHBWn.js";var f=o(l()),p=o(r()),m=()=>{let{t:r}=s(),o=d(),l=c(),[m]=a(),h=m.get(`token`),[g,_]=(0,f.useState)(!0),[v,y]=(0,f.useState)(!1),[b,x]=(0,f.useState)(`verifying`),[S,C]=(0,f.useState)(``);(0,f.useEffect)(()=>{if(!h){x(`error`),C(r(`invalid_token`)),_(!1);return}(async()=>{try{let{user:i}=await t.verifyEmail(h)||{};i&&l(e(i)),x(`success`),C(r(`verify_successed`)),n(r(`verify_successed`)),setTimeout(()=>{window.close()},4e3)}catch(e){let t=e.response?.status;t===400||t===404||t===422?localStorage.getItem(`refresh_token`)?(x(`not-verified`),C(r(`not_verified`)),n.message?.(r(`not_verified`))||n(r(`not_verified`))):(x(`not-verified-no-auth`),C(r(`need_login_to_verify`)),n.message?.(r(`need_login_to_verify`))||n(r(`need_login_to_verify`))):(x(`error`),C(r(`verify_failed`)),n.error(e.response?.data?.message||r(`verify_failed`)))}finally{_(!1)}})()},[l,o,r,h]);let w=async()=>{y(!0);try{await t.resendVerificationEmail(),n.success(r(`verifying_email_sent`)),C(r(`check_email`))}catch(e){let t=e.response?.data?.message||r(`verify_failed`);n.error(t)}finally{y(!1)}};return(0,p.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6! flex flex-col gap-2! absolute! top-full! left-[50%]! -translate-x-[50%] translate-y-full`,children:[(b===`verifying`||g)&&(0,p.jsxs)(`div`,{className:`flex flex-col gap-2.5! items-center`,children:[(0,p.jsx)(i,{className:`w-12 h-12`}),(0,p.jsx)(`p`,{className:`mt-4 text-lg text-foreground`,children:r(`verifying`)})]}),b===`not-verified`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center gap-2.5!`,children:[(0,p.jsx)(`h1`,{className:`text-2xl! font-bold! text-foreground mb-2!`,children:r(`verify_email_title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6 text-center`,children:S}),(0,p.jsx)(u,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i,{className:`mr-2`}),r(`sending`)]}):r(`resend_verify`)})]}),b===`success`&&(0,p.jsxs)(`div`,{className:`flex flex-col gap-2.5! items-center`,children:[(0,p.jsx)(`h1`,{className:`text-2xl! font-bold! text-foreground mb-2!`,children:r(`verify_successed`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-4`,children:S}),(0,p.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:r(`back_to_login`)}),(0,p.jsx)(Link,{to:`/auth/login`,state:{verified:!0}})]}),b===`error`&&(0,p.jsxs)(`div`,{className:`flex flex-col! gap-2.5! items-center`,children:[(0,p.jsx)(`h1`,{className:`text-2xl! font-bold! text-foreground mb-2!`,children:r(`verify_failed`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6!`,children:S}),(0,p.jsx)(u,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i,{className:`mr-2!`}),r(`sending`)]}):r(`resend_verify`)})]})]})};export{m as default};