import{B as e,G as t,H as n,Q as r,U as i,V as a,W as o,X as s,Y as c,Z as l,a as u,b as d,d as f,i as p,l as m,m as h,n as g,o as _,p as v,r as y,s as b,t as x,u as S,z as C}from"./index-Bqtm8eVw.js";var w=a(`hash`,[[`line`,{x1:`4`,x2:`20`,y1:`9`,y2:`9`,key:`4lhtct`}],[`line`,{x1:`4`,x2:`20`,y1:`15`,y2:`15`,key:`vyu0kd`}],[`line`,{x1:`10`,x2:`8`,y1:`3`,y2:`21`,key:`1ggp8o`}],[`line`,{x1:`16`,x2:`14`,y1:`3`,y2:`21`,key:`weycgp`}]]),T=a(`search`,[[`path`,{d:`m21 21-4.34-4.34`,key:`14j7rj`}],[`circle`,{cx:`11`,cy:`11`,r:`8`,key:`4ej97u`}]]),E=r(l());function D(e,t){let[n,r]=(0,E.useState)(e);return(0,E.useEffect)(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n}var O=D,k=r(n());function A({value:e,onChange:t,onSearch:n}){let{t:r}=o(),[i,a]=(0,E.useState)(e||``),s=O(i,500),c=(0,E.useRef)(!1);(0,E.useEffect)(()=>{if(c.current){c.current=!1;return}s!==e&&(t?.(s),s.trim()&&n?.(s.trim()))},[s,e,t,n]),(0,E.useEffect)(()=>{a(e||``)},[e]);let l=(0,E.useCallback)(()=>{c.current=!0,a(``),t?.(``)},[t]);return(0,k.jsxs)(`div`,{className:`relative`,children:[(0,k.jsx)(T,{className:`absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground`}),(0,k.jsx)(m,{type:`text`,value:i,onChange:e=>a(e.target.value),placeholder:r(`write_sth`),className:`pl-10 pr-10 h-11 bg-secondary/50 border-none rounded-xl focus-visible:ring-1`}),i&&(0,k.jsx)(`button`,{type:`button`,onClick:l,className:`absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 rounded-full bg-muted-foreground/20 hover:bg-muted-foreground/30 flex items-center justify-center transition-colors`,children:(0,k.jsx)(C,{className:`h-3 w-3 text-muted-foreground`})})]})}var j=A,M=[`all`,`topics`,`users`];function N({activeMode:e,onChange:t}){let{t:n}=o();return(0,k.jsx)(`div`,{className:`flex border-b border-border`,children:M.map(r=>(0,k.jsxs)(`button`,{onClick:()=>t(r),className:i(`flex-1 py-3 text-sm font-medium transition-colors relative`,e===r?`text-foreground`:`text-muted-foreground !hover:text-foreground/80`),children:[n(`${r}`),e===r&&(0,k.jsx)(`span`,{className:`absolute bottom-0 left-0! right-0! h-0.5! bg-foreground`})]},r))})}var P=N;function F({user:n}){let{t:r}=o(),i=c(),a=s(d),[l,u]=(0,E.useState)(!1),[p,m]=(0,E.useState)(!1);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(`div`,{className:`flex items-start gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,k.jsx)(v,{currentUser:n}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,k.jsxs)(`div`,{className:`flex items-center gap-1!`,children:[(0,k.jsx)(`span`,{className:`font-semibold! text-sm truncate`,children:n.username}),n.verified&&(0,k.jsx)(e,{className:`h-4 w-4 text-blue-500 shrink-0`})]}),n.name&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground truncate`,children:n.name}),n.bio&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-2 mt-0.5`,children:n.bio}),(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground mt-1!`,children:r(`followers`,{count:n.followers_count||0})})]}),(0,k.jsx)(h,{variant:n.is_following?`outline`:`default`,size:`sm`,onClick:async()=>{if(!a){m(!0);return}u(!0);try{n.is_following?(await i(b(n.id)).unwrap(),t.success(r(`followed`))):(await i(x(n.id)).unwrap(),t.success(r(`unfollowed`)))}catch(e){t.error(r(`follow_failed`,{message:e}))}finally{u(!1)}},disabled:l,className:`shrink-0 rounded-lg! px-5!`,children:n.is_following?r(`following`):r(`follow`)})]}),(0,k.jsx)(f,{open:p,onOpenChange:m})]})}var I=F;function L({topic:e}){let{t}=o();return(0,k.jsxs)(`div`,{className:`flex items-center gap-3! p-4! hover:bg-secondary/30 transition-colors cursor-pointer`,children:[(0,k.jsx)(`div`,{className:`h-10 w-10 rounded-full bg-secondary flex items-center justify-center shrink-0`,children:(0,k.jsx)(w,{className:`h-5 w-5 text-muted-foreground`})}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[(0,k.jsx)(`p`,{className:`font-semibold text-sm`,children:e.name}),e.description&&(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground line-clamp-1`,children:e.description}),(0,k.jsx)(`p`,{className:`text-sm text-muted-foreground mt-0.5!`,children:t(`posts`,{count:e.posts_count||0})})]})]})}var R=L;function z({type:e=`user`}){return(0,k.jsxs)(`div`,{className:`flex items-start gap-3 p-4`,children:[(0,k.jsx)(S,{className:`h-10 w-10 rounded-full shrink-0`}),(0,k.jsxs)(`div`,{className:`flex-1 min-w-0 space-y-2`,children:[(0,k.jsx)(S,{className:`h-4 w-24`}),(0,k.jsx)(S,{className:`h-3 w-32`}),e===`user`&&(0,k.jsx)(S,{className:`h-3 w-20`})]}),e===`user`&&(0,k.jsx)(S,{className:`h-8 w-20 rounded-xl shrink-0`})]})}var B=z;function V(){let{t:e}=o(),t=c(),{query:n,searchMode:r,topics:i,users:a,loading:l}=s(e=>e.search),d=(0,E.useCallback)((e,n)=>{n===`users`?t(g({page:1,perPage:20})):e.trim()&&(n===`all`?t(y({query:e,page:1})):n===`topics`&&t(p({query:e})))},[t]),f=(0,E.useCallback)(e=>{t(_(e)),d(e,r)},[t,r,d]),m=(0,E.useCallback)(e=>{t(u(e)),d(n,e)},[t,n,d]);(0,E.useEffect)(()=>{window.scrollTo(0,0),r===`users`&&a.length===0&&t(g({page:1,perPage:20}))},[t,r,a.length]);let h=()=>(0,k.jsx)(k.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,k.jsx)(B,{type:r===`topics`?`topic`:`user`},t))}),v=()=>i.length===0&&n&&!l?(0,k.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):i.map(e=>(0,k.jsx)(R,{topic:e},e.id)),b=()=>a.length===0&&!l?(0,k.jsx)(`p`,{className:`text-center! text-muted-foreground! py-8!`,children:e(`no_result`)}):a.map(e=>(0,k.jsx)(I,{user:e},e.id));return(0,k.jsx)(`div`,{id:`Search`,className:`w-full max-w-[700px]! flex justify-center px-6! md:px-0!`,children:(0,k.jsxs)(`div`,{className:`w-full! md:min-w-[380px] h-[calc(100%-60px)]`,children:[(0,k.jsx)(`div`,{className:`p-4!`,children:(0,k.jsx)(j,{value:n,onChange:e=>t(_(e)),onSearch:f})}),(0,k.jsx)(P,{activeMode:r,onChange:m}),(0,k.jsx)(`div`,{className:`flex flex-col gap-1 divide-y! divide-border!`,children:(()=>{if(l)return h();switch(r){case`topics`:return v();case`users`:return b();case`all`:default:{let t=i.length>0,r=a.length>0;return!t&&!r&&n?(0,k.jsx)(`p`,{className:`text-center text-muted-foreground py-8`,children:e(`no_result`)}):(0,k.jsxs)(k.Fragment,{children:[t&&(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`topics`)}),i.slice(0,3).map(e=>(0,k.jsx)(R,{topic:e},e.id))]}),r&&(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`h3`,{className:`px-4! py-2! text-sm! font-semibold! text-muted-foreground!`,children:e(`users`)}),a.map(e=>(0,k.jsx)(I,{user:e},e.id))]})]})}}})()})]})})}var H=V;export{H as default};